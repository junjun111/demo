<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/reset.css"/>
    <link href="css/mui.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="css/swiper-3.4.2.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/getFollowers.css"/>
    <link rel="stylesheet" type="text/css" href="css/gitLikes.css"/>
    <style type="text/css">
    	.mui-content{
			  background-image: url(img/b_like_1.png);
			  background-repeat: no-repeat;
			  background-size: 100% 100%;
		}
		/* 去掉蒙版三角形  */
		.mui-popover .mui-popover-arrow:after {
			position: static;
		}
		.swiper-container{
			display: none;
			width:100%;
			height:1rem;
		}
		.swiper-slide {
	      display: -webkit-box;
	      display: -ms-flexbox;
	      display: -webkit-flex;
	      display: flex;
	      -webkit-box-pack: center;
	      -ms-flex-pack: center;
	      -webkit-justify-content: center;
	      justify-content: center;
	      -webkit-box-align: center;
	      -ms-flex-align: center;
	      -webkit-align-items: center;
	      align-items: center;
	      /*width: 0.74rem;*/
	    }
	    .smallW{
	    	width:0.74rem;
	    }
	    .addW{
	    	width:1rem;
	    }
	    
    </style>
</head>
<body>
	<div class="mui-off-canvas-wrap mui-draggable mui-slide-in">
  <!-- 主页面容器 -->
  <div class="mui-inner-wrap">
     <!-- 菜单容器 -->
    <aside class="mui-off-canvas-left bg_w">
      <div class="mui-scroll-wrapper">
        <div class="mui-scroll">
          <!-- 菜单具体展示内容 -->
         <header class="mui-bar mui-bar-nav">
             <a class="mui-icon mui-icon-forward mui-pull-right"></a>
             <h1 class="mui-title">Setting</h1>
         </header>
         <ul class="mui-table-view" style="top:0.44rem;">
                 <li class="mui-table-view-cell" style="display: flex;justify-content: space-between;align-items: center;">
                 	<div>
                 		<img src="img/like_bu_49@3x.png" style="width:0.2rem;display: inline;"/>
                 		<span>Store</span>
                 	</div>
                     <a class="mui-navigate-right"></a>
                 </li>
                 <li class="mui-table-view-cell" style="display: flex;justify-content: space-between;align-items: center;">
                 	<div>
                 		<img src="img/like_bu_49@3x.png" style="width:0.2rem;display: inline;"/>
                 		<span>Check in</span>
                 	</div>
                     <a class="mui-navigate-right"></a>
                 </li>
                 <li class="mui-table-view-cell" style="display: flex;justify-content: space-between;align-items: center;">
                 	<div>
                 		<img src="img/like_bu_49@3x.png" style="width:0.2rem;display: inline;"/>
                 		<span>Follow us on Instrgram</span>
                 	</div>
                     <a class="mui-navigate-right"></a>
                 </li>
                 <li class="mui-table-view-cell" style="display: flex;justify-content: space-between;align-items: center;">
                 	<div>
                 		<img src="img/like_bu_49@3x.png" style="width:0.2rem;display: inline;"/>
                 		<span>Store</span>
                 	</div>
                     <a class="mui-navigate-right"></a>
                 </li>
                 <li class="mui-table-view-cell" style="display: flex;justify-content: space-between;align-items: center;">
                 	<div>
                 		<img src="img/like_bu_49@3x.png" style="width:0.2rem;display: inline;"/>
                 		<span>Store</span>
                 	</div>
                     <a class="mui-navigate-right"></a>
                 </li>
             </ul>
        </div>
      </div>
    </aside>
    <!-- 主页面标题 -->
     
    <!-- 主页面内容容器 -->
    <div class="mui-content bg mui-scroll-wrapper">
      <div class="mui-scroll">
	        <!-- 主界面具体展示内容 -->
	        <div id="header">
			<div class="header_icon">
	    	  <a class="mui-action-menu mui-icon mui-icon-bars mui-pull-left white"></a>
	    	  <h1 class="white nomal_txt userName" style="width:100%;text-align: center;margin-right:0.3rem"></h1>
	       </div>        
			<div class="user_img">
				<!--<div class="followers">
						<span class="big_txt follower_count  white"></span>
						<span class="smallTxt white"></span>
				</div>-->
				<a href="#popover" id="openPopover"><img id="user_imgUrl" src="img/b_like_35.png"/></a>
				<!--<div class="following">
						<span class="big_txt following_count white"></span>
						<span class="smallTxt white"></span>
				</div>-->
				<div class="swiper-container">
				    <div class="swiper-wrapper">	   
				      
				    </div>
				 </div>	
			</div>
			<div class="postBox">
				<div class="bg_triangle"></div>
					<div class="post_news">
						<div class="addlike">
							<img src="img/b_like_82.png" style="width:0.16rem" /><span id="post_like">100</span>
						</div>
						<div class="addcomment">
							<img src="img/b_like_81.png" style="width:0.16rem" /><span id="post_comment">100</span>
						</div>
				   </div>
			</div>
			
		</div>
		<div id="sec">
	    	<div class="time_active">
	    		<div class="" style="width:100%;height:0.5rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src=""/></span>
	    				<span> x 30</span>
	    			</div>
	    			<div style="width:1rem;height:0.3rem;line-height:0.3rem;border-radius: 1rem;color:#fff;background:#ff3273;text-align: center;">$30.00</div>
	    		</div>
	    	</div>
	    	<div class="add">
	    		<!--<div class="add_F">
	    			<span id="follower"><a href="javascript:void(0);">Likes</a></span>
	    			<span id="Gfollower"><a href="javascript:void(0);">Golden Likes</a></span>
	    		</div>-->
	    		<div class="load_follower">
	    			
	    		</div>
	    		<!--<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 10</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>
	    		<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 100</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>
	    		<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 300</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>
	    		<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 800</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>
	    		<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 2500</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>
	    		<div class="" style="width:100%;height:0.6rem;display: flex;justify-content: space-around;align-items: center;">
	    			<div>
	    				<span><img src="img/b_like_18.png" style="width:0.16rem;display: inline;"/></span>
	    				<span> x 5000</span>
	    			</div>
	    			<div>$30.00</div>
	    		</div>-->
	    	</div>
	    </div>
      </div>
    </div>
    <footer>
    	<a class="middle" href="index.html">
    		<img src="img/b_like_13.png" style="width:0.2rem;display: block;" />
    		<span>Get Followers</span>
    	</a>
    	<a class="middle" href="getLikes.html">
    		<img src="img/b_like_82.png" style="width:0.2rem;display: block;" />
    		<span>Get Likes</span>
    	</a>
    	<a class="middle" href="vip.html">
    		<img src="img/b_like_12.png" style="width:0.2rem;display: block;" />
    		<span>VIP</span>
       </a>
    	<a class="middle" href="">
    		<img src="img/b_like_14.png" style="width:0.2rem;display: block;" />
    		<span>Get Coins</span>
    	</a>
    	<a class="middle" href="">
    		<img src="img/b_like_11.png" style="width:0.2rem;display: block;" />
    		<span>Store</span>
    	</a>
    </footer> 
  </div>
</div>
<div id="popover" class="mui-popover">
	    <div class="mb">
	    	<div class="login_close">
		    	  <img class="img_close" src="img/b_like_49.png" style="width:0.16rem"/>
		    </div>
		    <p>Please input your Instagram name</p>
		    <input type="text" name="txt" id="txt" value=""/>
		    <p class="red warn">This account is invalid,please re-enter</p>
		    <button type="button" class="mui-btn mui-btn-primary">Next</button>
		    <img src='img/loadani.gif' class="load_img"/>
	    </div>
</div>
</body>
<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
<script src="js/puplic.js" type="text/javascript" charset="utf-8"></script>
<script src="js/jquery.js" type="text/javascript" charset="utf-8"></script>
<script src="js/loading_ajax.js" type="text/javascript" charset="utf-8"></script>
<script src="js/swiper-3.4.2.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
    mui.init({
			swipeBack: false,
		});
	mui.ready(function(){
		
		//先清空在加载
   		$(".load_follower").html("");
		//加载服务器数据
		Mlikes();
		
		//点击加载相应数据

		//加载本地数据
		var data = JSON.parse(localStorage.getItem('data'));
	    //console.log(data);
	    
	    //获取数据
	    if(data){
	    	//展示数据
	    	$('.swiper-container').css("display","block");
	    	$('.postBox').css("display","flex");
	    	$('#openPopover').css("display","none");
	    	
	    	var numImg = data.entry_data.ProfilePage[0].graphql.user.edge_owner_to_timeline_media.edges;
	    	console.log(numImg);
	    	var imgSrc = numImg[0].node.display_url;
	    	
	    	var post_like = numImg[0].node.edge_liked_by.count;
	    	var post_comment = numImg[0].node.edge_media_to_comment.count;
		    var userName = data.entry_data.ProfilePage[0].graphql.user.username;
			
			//页面赋值，加载用户信息
			$(".userName").html(userName);
			
			//加载第一张帖子信息
			$("#post_like").html(post_like);
			$("#post_comment").html(post_comment);
	        
	        //循环创建图片节点
	        for (var i = 0;i < numImg.length;i++) {
	        	var imgSrc = numImg[i].node.display_url;
	        	var slide = '<div class="swiper-slide"><img src="'+imgSrc+'" class="smallW"/></div>';
	        	
	        	//动态添加发帖信息
	        	$(".swiper-wrapper").append(slide);  	
	        }
	        
	        //swiper轮播插件
			    var mySwiper = new Swiper('.swiper-container', {
			      slidesPerView: '3',
			      centeredSlides: true,
			      spaceBetween: 20,
			      onSlideChangeStart: function(swiper){
			      	//获取当前活动板块索引值
			      	var index = swiper.activeIndex;
			      	
			      	//根据索引值加载帖子信息
			      	var post_like = numImg[index].node.edge_liked_by.count;
			      	var post_comment = numImg[index].node.edge_media_to_comment.count;

			      	//放大当前活动板块
			      	$('.swiper-slide').not(':eq(index)').find("img").removeClass('addW');
			      	$('.swiper-slide').eq(index).find("img").addClass('addW');
			      	
			      	//清空帖子信息内容
			      	$("#post_like").html(post_like);
			      	$("#post_comment").html(post_comment);
			      }		     
			 });
	    	//第一个图片放大
	    	$('.swiper-slide').eq(0).find("img").addClass('addW');
	    }else{
	    	$('.swiper-container').css("display","none");
	    	$('.postBox').css("display","none");
	    	$('#openPopover').css("display","block");
	    }
	    
	    //开启弹出框
		mui('#header').on('tap','.mui-action-menu',function(){
  	  	mui('.mui-off-canvas-wrap').offCanvas().toggle();
		});
		
		//关闭弹出框
		mui('.mb').on('tap','.img_close',function(){
			mui('#popover').popover('toggle');
	  		//document.getElementsByClassName('mb')[0].style.display = 'none';
		});
		
		//页面滚动
		(function($){
	    $(".mui-scroll-wrapper").scroll({
	        //bounce: false,//滚动条是否有弹力默认是true
	        //indicators: false, //是否显示滚动条,默认是true
	    }); 
	    })(mui);
	    
	    
	    //获取数据
        mui('.mb').on('tap','.mui-btn',function(){
	  		 var txt = document.getElementById('txt').value;
	  		 var BASE_URL = 'https://www.instagram.com/';
			 var LOGIN_URL = BASE_URL + txt + '/';
			 $.ajax({
				          method: "GET",
				          url: LOGIN_URL,
				          dataType: "html",
				          beforeSend: function(xhr) {
				          	//出现加载动画
				          	$(".load_img").css("display","block");
				           },
				          //cache: false,
				          success: function(data) {
				          	//蒙层消失
				          	mui('#popover').popover('toggle');
				          	
				          	//数据处理
				          	var dataStr = JSON.stringify(data);
							var datarep = dataStr.replace(/(\r\n)|(\n)/g,"");
							var n = datarep.match(/(window._sharedData\s?)(=\s?)(.*?);<\/script>/)[3];
							n = n.replace(/\\/g,"");
							var jsonStr = JSON.parse(n);
							var img_url = jsonStr.entry_data.ProfilePage[0].graphql.user.profile_pic_url;
							localStorage.setItem('data', n);
							
							//打开新页面
				          	mui.openWindow({
				          		url:'accountConfirm.html',
				          		id:'accountConfirm',
                                styles:{
                                    top:'0px',
                                    bottom:'0px'
                                },
								extras:{}
				          	})
				          },
				          error: function(err) {
				          	$(".load_img").css("display","none");
				          	$('.warn').css('display','block');
				          },
				          complete: function(XMLHttpRequest, status) {
				          	//请求完成后最终执行参数 	　
				       }
		      })
		})
        
        //解决a链接无法跳转，实现点击跳转页面
        mui('footer').on('tap','a',function(){
		    window.top.location.href=this.href;
		});
	})
    </script>
</html>